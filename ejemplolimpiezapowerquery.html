<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centro de Soluciones Power Query - Instituto Tecnipro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #0063B2 0%, #1a8ad3 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 3px solid #e0e0e0;
            overflow-x: auto;
        }
        
        .nav-tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            background: #f8f9fa;
            border: none;
            font-size: 15px;
            color: #495057;
            transition: all 0.3s ease;
            position: relative;
            min-width: 200px;
        }
        
        .nav-tab:hover {
            background: #e9ecef;
        }
        
        .nav-tab.active {
            background: white;
            color: #0063B2;
            font-weight: 500;
        }
        
        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: #0063B2;
        }
        
        .content-area {
            padding: 40px;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Casos de Uso */
        .use-case-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .use-case-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .use-case-card:hover {
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transform: translateY(-2px);
            border-color: #0063B2;
        }
        
        .use-case-card h3 {
            color: #0063B2;
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
        }
        
        .use-case-card .icon {
            font-size: 28px;
            margin-right: 10px;
        }
        
        .use-case-card p {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .use-case-card .example {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            margin-top: 12px;
            font-size: 13px;
            color: #495057;
        }
        
        /* Soluciones */
        .solution-box {
            background: #e6f3ff;
            border-left: 5px solid #0063B2;
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .solution-box h4 {
            color: #0063B2;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .steps-list {
            counter-reset: step-counter;
            list-style: none;
            padding: 0;
        }
        
        .steps-list li {
            counter-increment: step-counter;
            position: relative;
            padding-left: 50px;
            margin-bottom: 15px;
            color: #495057;
        }
        
        .steps-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: #0063B2;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        /* Calculadora de limpieza */
        .data-cleaner {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        .sample-data {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .sample-data h4 {
            color: #0063B2;
            margin-bottom: 15px;
        }
        
        .data-display {
            font-family: 'Consolas', monospace;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            margin-bottom: 15px;
        }
        
        .transformation-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .transform-btn {
            background: white;
            border: 2px solid #17a2b8;
            color: #17a2b8;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .transform-btn:hover {
            background: #17a2b8;
            color: white;
        }
        
        .transform-btn.active {
            background: #17a2b8;
            color: white;
        }
        
        /* Plantillas */
        .template-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .template-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .template-card h4 {
            color: #17a2b8;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .template-steps {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
        }
        
        /* Diagn√≥stico */
        .diagnostic-tool {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
        }
        
        .check-item {
            background: white;
            border: 1px solid #e0e0e0;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .check-item .status {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        .status.good {
            background: #e8f5e9;
            color: #4caf50;
        }
        
        .status.warning {
            background: #fff5eb;
            color: #ff9800;
        }
        
        .status.error {
            background: #ffebee;
            color: #f44336;
        }
        
        /* Tips y alertas */
        .tip-box {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .warning-box {
            background: #fff5eb;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .info-box {
            background: #e6f3ff;
            border-left: 4px solid #0063B2;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-size: 14px;
        }
        
        /* Botones de acci√≥n */
        .action-button {
            background: #0063B2;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 15px;
            transition: all 0.3s ease;
            display: inline-block;
            text-align: center;
        }
        
        .action-button:hover {
            background: #004a8c;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,99,178,0.3);
        }
        
        .secondary-button {
            background: white;
            color: #0063B2;
            border: 2px solid #0063B2;
            padding: 10px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .secondary-button:hover {
            background: #0063B2;
            color: white;
        }
        
        @media (max-width: 768px) {
            .use-case-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tab {
                font-size: 13px;
                padding: 15px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="header">
            <h1>üè¢ Centro de Soluciones Power Query</h1>
            <p>Resuelve los desaf√≠os m√°s comunes de limpieza y transformaci√≥n de datos</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('casos')">
                üíº Casos de Uso Comunes
            </button>
            <button class="nav-tab" onclick="showTab('limpieza')">
                üßπ Asistente de Limpieza
            </button>
            <button class="nav-tab" onclick="showTab('plantillas')">
                üìã Plantillas Listas
            </button>
            <button class="nav-tab" onclick="showTab('diagnostico')">
                üîç Diagn√≥stico de Datos
            </button>
            <button class="nav-tab" onclick="showTab('tips')">
                üí° Tips R√°pidos
            </button>
        </div>
        
        <div class="content-area">
            <!-- Tab 1: Casos de Uso Comunes -->
            <div id="casos" class="tab-content active">
                <h2 style="color: #0063B2; margin-bottom: 30px;">Casos de Uso M√°s Frecuentes en el √Årea Administrativa</h2>
                
                <div class="use-case-grid">
                    <div class="use-case-card" onclick="showSolution('consolidar-reportes')">
                        <h3><span class="icon">üìä</span> Consolidar Reportes Mensuales</h3>
                        <p>Necesito unir reportes de ventas de diferentes meses que est√°n en archivos Excel separados.</p>
                        <div class="example">
                            <strong>Ejemplo:</strong> Ventas_Enero.xlsx, Ventas_Febrero.xlsx, Ventas_Marzo.xlsx ‚Üí Ventas_Trimestre1
                        </div>
                    </div>
                    
                    <div class="use-case-card" onclick="showSolution('limpiar-nombres')">
                        <h3><span class="icon">üë•</span> Estandarizar Nombres de Clientes</h3>
                        <p>Los nombres de clientes vienen en diferentes formatos y necesito unificarlos para evitar duplicados.</p>
                        <div class="example">
                            <strong>Ejemplo:</strong> "JUAN PEREZ", "juan perez", "Juan  P√©rez" ‚Üí "Juan P√©rez"
                        </div>
                    </div>
                    
                    <div class="use-case-card" onclick="showSolution('categorizar-gastos')">
                        <h3><span class="icon">üí∞</span> Categorizar Gastos Autom√°ticamente</h3>
                        <p>Tengo una lista de gastos y necesito asignarles categor√≠as seg√∫n el monto o descripci√≥n.</p>
                        <div class="example">
                            <strong>Ejemplo:</strong> Gastos > $10,000 = "Alto", $5,000-$10,000 = "Medio", < $5,000 = "Bajo"
                        </div>
                    </div>
                    
                    <div class="use-case-card" onclick="showSolution('limpiar-rut')">
                        <h3><span class="icon">üÜî</span> Formatear RUT/ID Correctamente</h3>
                        <p>Los RUT vienen con puntos, guiones o sin formato y necesito estandarizarlos.</p>
                        <div class="example">
                            <strong>Ejemplo:</strong> "12345678-9", "12.345.678-9", "123456789" ‚Üí "12.345.678-9"
                        </div>
                    </div>
                    
                    <div class="use-case-card" onclick="showSolution('calcular-antiguedad')">
                        <h3><span class="icon">üìÖ</span> Calcular Antig√ºedad de Empleados</h3>
                        <p>Necesito calcular autom√°ticamente los a√±os de servicio bas√°ndome en la fecha de ingreso.</p>
                        <div class="example">
                            <strong>Ejemplo:</strong> Fecha Ingreso: 15/03/2020 ‚Üí Antig√ºedad: 4 a√±os
                        </div>
                    </div>
                    
                    <div class="use-case-card" onclick="showSolution('resumir-ventas')">
                        <h3><span class="icon">üìà</span> Resumir Ventas por Regi√≥n</h3>
                        <p>Tengo ventas detalladas y necesito un resumen por regi√≥n con totales y promedios.</p>
                        <div class="example">
                            <strong>Ejemplo:</strong> 1000 transacciones ‚Üí Resumen: Norte $2.5M, Sur $1.8M, Centro $3.2M
                        </div>
                    </div>
                </div>
                
                <div id="solution-display"></div>
            </div>
            
            <!-- Tab 2: Asistente de Limpieza -->
            <div id="limpieza" class="tab-content">
                <h2 style="color: #0063B2; margin-bottom: 30px;">Asistente Interactivo de Limpieza de Datos</h2>
                
                <div class="data-cleaner">
                    <div class="sample-data">
                        <h4>Datos de Ejemplo - Experimenta con las transformaciones</h4>
                        <div class="data-display">
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="border-bottom: 2px solid #0063B2;">
                                        <th style="padding: 10px; text-align: left;">Nombre Cliente</th>
                                        <th style="padding: 10px; text-align: left;">RUT</th>
                                        <th style="padding: 10px; text-align: left;">Monto Compra</th>
                                        <th style="padding: 10px; text-align: left;">Fecha</th>
                                    </tr>
                                </thead>
                                <tbody id="sample-table">
                                    <tr>
                                        <td style="padding: 10px;">MARIA GONZALEZ  </td>
                                        <td style="padding: 10px;">12345678-9</td>
                                        <td style="padding: 10px;">$1,250.00</td>
                                        <td style="padding: 10px;">15/03/2024</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 10px;">juan carlos silva</td>
                                        <td style="padding: 10px;">98.765.432-1</td>
                                        <td style="padding: 10px;">$ 850</td>
                                        <td style="padding: 10px;">2024-03-16</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 10px;">  Ana L√≥pez</td>
                                        <td style="padding: 10px;">11222333-4</td>
                                        <td style="padding: 10px;">2,100.50</td>
                                        <td style="padding: 10px;">16/03/24</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <h4 style="margin-top: 25px; color: #0063B2;">Aplica estas transformaciones:</h4>
                        <div class="transformation-options">
                            <button class="transform-btn" onclick="applyClean('trim')">
                                ‚úÇÔ∏è Quitar espacios extras
                            </button>
                            <button class="transform-btn" onclick="applyClean('properCase')">
                                üìù Formato nombre propio
                            </button>
                            <button class="transform-btn" onclick="applyClean('formatRut')">
                                üÜî Formatear RUT
                            </button>
                            <button class="transform-btn" onclick="applyClean('cleanMoney')">
                                üí≤ Limpiar montos
                            </button>
                            <button class="transform-btn" onclick="applyClean('standardDate')">
                                üìÖ Estandarizar fechas
                            </button>
                            <button class="transform-btn" onclick="resetSampleData()">
                                üîÑ Restaurar original
                            </button>
                        </div>
                        
                        <div id="transformation-result"></div>
                    </div>
                    
                    <div class="tip-box">
                        <strong>üí° Tip:</strong> En Power Query, estas transformaciones se aplican en el orden que las selecciones. 
                        Cada transformaci√≥n se guarda como un "paso" que puedes modificar o eliminar m√°s tarde.
                    </div>
                </div>
            </div>
            
            <!-- Tab 3: Plantillas Listas -->
            <div id="plantillas" class="tab-content">
                <h2 style="color: #0063B2; margin-bottom: 30px;">Plantillas de Transformaci√≥n Listas para Usar</h2>
                
                <div class="template-card">
                    <h4>üìä Plantilla: Consolidaci√≥n de Reportes Mensuales</h4>
                    <p>Use esta secuencia cuando necesite unir m√∫ltiples archivos Excel con la misma estructura.</p>
                    <div class="template-steps">
                        <ol class="steps-list">
                            <li>En Power BI Desktop, vaya a <strong>Obtener datos ‚Üí Carpeta</strong></li>
                            <li>Seleccione la carpeta donde est√°n todos sus archivos mensuales</li>
                            <li>Power Query mostrar√° todos los archivos. Haga clic en <strong>Combinar ‚Üí Combinar y transformar</strong></li>
                            <li>Seleccione la hoja que contiene los datos (generalmente "Hoja1")</li>
                            <li>Power Query unir√° autom√°ticamente todos los archivos</li>
                            <li>Agregue una columna personalizada para identificar el mes: <strong>Agregar columna ‚Üí Columna personalizada</strong></li>
                            <li>Aplique las transformaciones de limpieza necesarias</li>
                            <li>Haga clic en <strong>Cerrar y aplicar</strong></li>
                        </ol>
                    </div>
                </div>
                
                <div class="template-card">
                    <h4>üë• Plantilla: Base de Datos de Clientes Limpia</h4>
                    <p>Secuencia completa para estandarizar informaci√≥n de clientes.</p>
                    <div class="template-steps">
                        <ol class="steps-list">
                            <li>Seleccione las columnas de texto (Nombre, Direcci√≥n, Ciudad)</li>
                            <li>Aplique <strong>Transformar ‚Üí Formato ‚Üí Recortar</strong> para quitar espacios</li>
                            <li>Aplique <strong>Transformar ‚Üí Formato ‚Üí Limpiar</strong> para caracteres invisibles</li>
                            <li>Para nombres: <strong>Transformar ‚Üí Formato ‚Üí Poner cada palabra en may√∫sculas</strong></li>
                            <li>Para RUT: Cree columna personalizada con formato correcto</li>
                            <li>Elimine duplicados: <strong>Inicio ‚Üí Quitar filas ‚Üí Quitar duplicados</strong></li>
                            <li>Valide que no haya valores vac√≠os en campos obligatorios</li>
                        </ol>
                    </div>
                </div>
                
                <div class="template-card">
                    <h4>üìà Plantilla: An√°lisis de Ventas por Per√≠odo</h4>
                    <p>Transforme datos transaccionales en res√∫menes gerenciales.</p>
                    <div class="template-steps">
                        <ol class="steps-list">
                            <li>Aseg√∫rese de que la columna de fecha tenga el tipo correcto</li>
                            <li>Agregue columnas de a√±o y mes: <strong>Agregar columna ‚Üí Fecha ‚Üí A√±o/Mes</strong></li>
                            <li>Vaya a <strong>Transformar ‚Üí Agrupar por</strong></li>
                            <li>Agrupe por: A√±o, Mes, Producto (o las dimensiones que necesite)</li>
                            <li>Agregue las operaciones: Suma de Ventas, Promedio de Ventas, Cantidad de transacciones</li>
                            <li>Ordene por fecha descendente para ver los datos m√°s recientes primero</li>
                            <li>Aplique formato de moneda a las columnas num√©ricas</li>
                        </ol>
                    </div>
                </div>
            </div>
            
            <!-- Tab 4: Diagn√≥stico de Datos -->
            <div id="diagnostico" class="tab-content">
                <h2 style="color: #0063B2; margin-bottom: 30px;">Diagn√≥stico R√°pido de Calidad de Datos</h2>
                
                <div class="diagnostic-tool">
                    <p style="margin-bottom: 25px;">Use esta lista de verificaci√≥n para identificar problemas comunes en sus datos antes de crear reportes:</p>
                    
                    <div class="check-item">
                        <div>
                            <strong>Espacios innecesarios en textos</strong>
                            <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">Espacios al inicio, final o m√∫ltiples espacios entre palabras</p>
                        </div>
                        <div class="status warning">‚ö†Ô∏è</div>
                    </div>
                    
                    <div class="check-item">
                        <div>
                            <strong>Formatos de fecha inconsistentes</strong>
                            <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">DD/MM/YYYY, MM-DD-YYYY, YYYY/MM/DD mezclados</p>
                        </div>
                        <div class="status error">‚ùå</div>
                    </div>
                    
                    <div class="check-item">
                        <div>
                            <strong>May√∫sculas y min√∫sculas inconsistentes</strong>
                            <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">JUAN P√âREZ, juan p√©rez, Juan P√©rez</p>
                        </div>
                        <div class="status warning">‚ö†Ô∏è</div>
                    </div>
                    
                    <div class="check-item">
                        <div>
                            <strong>Valores monetarios con s√≠mbolos</strong>
                            <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">$1,250.00, $ 1250, 1250.00</p>
                        </div>
                        <div class="status good">‚úì</div>
                    </div>
                    
                    <div class="check-item">
                        <div>
                            <strong>Duplicados potenciales</strong>
                            <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">Mismos clientes con variaciones en el nombre</p>
                        </div>
                        <div class="status error">‚ùå</div>
                    </div>
                    
                    <div class="warning-box">
                        <strong>‚ö†Ô∏è Importante:</strong> Corrija estos problemas en Power Query antes de crear visualizaciones. 
                        Los datos limpios son la base de reportes confiables.
                    </div>
                    
                    <button class="action-button" style="margin-top: 20px;" onclick="showDiagnosticSteps()">
                        Ver Pasos para Corregir Estos Problemas
                    </button>
                </div>
            </div>
            
            <!-- Tab 5: Tips R√°pidos -->
            <div id="tips" class="tab-content">
                <h2 style="color: #0063B2; margin-bottom: 30px;">Tips R√°pidos para el D√≠a a D√≠a</h2>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div class="tip-box">
                        <strong>üöÄ Filtrar antes de transformar</strong><br>
                        Si solo necesita datos del √∫ltimo a√±o, filtre primero. Esto hace que todas las transformaciones sean m√°s r√°pidas.
                    </div>
                    
                    <div class="tip-box">
                        <strong>üìã Duplicar columnas antes de transformar</strong><br>
                        Si no est√° seguro del resultado, duplique la columna original. As√≠ siempre puede volver atr√°s.
                    </div>
                    
                    <div class="tip-box">
                        <strong>üîÑ Use "Columna de ejemplos"</strong><br>
                        Power Query puede detectar patrones. Escriba 2-3 ejemplos y √©l completar√° el resto autom√°ticamente.
                    </div>
                    
                    <div class="tip-box">
                        <strong>üìä Agrupe datos temprano</strong><br>
                        Si su reporte final es un resumen, agrupe los datos en Power Query, no en Power BI. Es m√°s eficiente.
                    </div>
                    
                    <div class="tip-box">
                        <strong>üóìÔ∏è Columnas de fecha inteligentes</strong><br>
                        Agregue columnas de A√±o, Trimestre, Mes desde el principio. Facilitar√° mucho sus an√°lisis temporales.
                    </div>
                    
                    <div class="tip-box">
                        <strong>üíæ Nombre sus pasos claramente</strong><br>
                        En lugar de "Filas filtradas1", use "Filtrar solo ventas 2024". Su yo futuro se lo agradecer√°.
                    </div>
                </div>
                
                <div class="info-box" style="margin-top: 30px;">
                    <h4 style="margin-top: 0;">üìå El tip m√°s importante:</h4>
                    <p>Power Query registra cada acci√≥n como un paso. Si algo sale mal, simplemente elimine ese paso y vuelva a intentarlo. 
                    <strong>No hay forma de "romper" los datos originales</strong> - Power Query nunca los modifica.</p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Cambiar tabs
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.nav-tab');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // Mostrar soluciones para casos de uso
        function showSolution(caso) {
            const solutionDiv = document.getElementById('solution-display');
            let content = '';
            
            switch(caso) {
                case 'consolidar-reportes':
                    content = `
                        <div class="solution-box">
                            <h4>‚úÖ Soluci√≥n: Consolidar Reportes Mensuales</h4>
                            <ol class="steps-list">
                                <li>En Power BI Desktop, haga clic en <strong>Obtener datos ‚Üí M√°s ‚Üí Carpeta</strong></li>
                                <li>Navegue y seleccione la carpeta que contiene todos sus archivos mensuales</li>
                                <li>Power Query mostrar√° la lista de archivos. Verifique que est√©n todos</li>
                                <li>Haga clic en el bot√≥n <strong>Combinar ‚Üí Combinar y transformar datos</strong></li>
                                <li>En la ventana que aparece, seleccione la tabla o hoja que contiene sus datos</li>
                                <li>Power Query crear√° autom√°ticamente una consulta que une todos los archivos</li>
                                <li>Agregue una columna con el nombre del archivo para identificar cada mes</li>
                                <li>Aplique las transformaciones de limpieza necesarias</li>
                                <li>Haga clic en <strong>Cerrar y aplicar</strong> cuando termine</li>
                            </ol>
                            <div class="tip-box" style="margin-top: 20px;">
                                <strong>üí° Tip Pro:</strong> Si agrega nuevos archivos mensuales a la carpeta, solo necesita actualizar 
                                y Power Query los incluir√° autom√°ticamente.
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'limpiar-nombres':
                    content = `
                        <div class="solution-box">
                            <h4>‚úÖ Soluci√≥n: Estandarizar Nombres de Clientes</h4>
                            <ol class="steps-list">
                                <li>Seleccione la columna con los nombres de clientes</li>
                                <li>Vaya a <strong>Transformar ‚Üí Formato ‚Üí Recortar</strong> (elimina espacios extras)</li>
                                <li>Luego <strong>Transformar ‚Üí Formato ‚Üí Limpiar</strong> (elimina caracteres invisibles)</li>
                                <li>Aplique <strong>Transformar ‚Üí Formato ‚Üí Poner cada palabra en may√∫sculas</strong></li>
                                <li>Para casos especiales (Ej: "de", "la"), use <strong>Reemplazar valores</strong></li>
                                <li>Revise la vista previa para verificar que todos los nombres est√©n correctos</li>
                                <li>Para encontrar duplicados: <strong>Inicio ‚Üí Agrupar por</strong> y cuente las ocurrencias</li>
                            </ol>
                            <div class="warning-box" style="margin-top: 20px;">
                                <strong>‚ö†Ô∏è Atenci√≥n:</strong> Antes de eliminar duplicados, verifique que realmente sean el mismo cliente 
                                y no clientes diferentes con nombres similares.
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'categorizar-gastos':
                    content = `
                        <div class="solution-box">
                            <h4>‚úÖ Soluci√≥n: Categorizar Gastos Autom√°ticamente</h4>
                            <ol class="steps-list">
                                <li>Vaya a <strong>Agregar columna ‚Üí Columna personalizada</strong></li>
                                <li>Nombre la columna como "Categor√≠a_Gasto"</li>
                                <li>Use esta estructura de condiciones:<br>
                                    <code style="background: #f8f9fa; padding: 10px; display: block; margin: 10px 0; border-radius: 4px;">
                                    if [Monto] > 10000 then "Alto"<br>
                                    else if [Monto] > 5000 then "Medio"<br>
                                    else "Bajo"
                                    </code>
                                </li>
                                <li>Para categor√≠as por descripci√≥n, use <strong>Text.Contains</strong>:<br>
                                    <code style="background: #f8f9fa; padding: 10px; display: block; margin: 10px 0; border-radius: 4px;">
                                    if Text.Contains([Descripci√≥n], "viaje") then "Vi√°ticos"<br>
                                    else if Text.Contains([Descripci√≥n], "almuerzo") then "Alimentaci√≥n"<br>
                                    else "Otros"
                                    </code>
                                </li>
                                <li>Verifique que todas las filas tengan categor√≠a asignada</li>
                                <li>Si necesita m√°s categor√≠as, agregue m√°s condiciones "else if"</li>
                            </ol>
                        </div>
                    `;
                    break;
                    
                case 'limpiar-rut':
                    content = `
                        <div class="solution-box">
                            <h4>‚úÖ Soluci√≥n: Formatear RUT Correctamente</h4>
                            <ol class="steps-list">
                                <li>Primero, elimine todos los puntos y guiones existentes:<br>
                                    <strong>Transformar ‚Üí Reemplazar valores</strong> ‚Üí Buscar "." Reemplazar con "" (vac√≠o)</li>
                                <li>Repita para el gui√≥n: Buscar "-" Reemplazar con "" (vac√≠o)</li>
                                <li>Ahora tiene RUT sin formato (ej: 123456789)</li>
                                <li>Cree una columna personalizada para agregar el formato:<br>
                                    <strong>Agregar columna ‚Üí Columna personalizada</strong></li>
                                <li>Use esta f√≥rmula para RUT chileno:<br>
                                    <code style="background: #f8f9fa; padding: 10px; display: block; margin: 10px 0; border-radius: 4px;">
                                    Text.Insert(Text.Insert(Text.Insert([RUT_Limpio], -1, "-"), -5, "."), -9, ".")
                                    </code>
                                </li>
                                <li>Verifique que todos los RUT tengan el formato correcto</li>
                                <li>Elimine la columna temporal sin formato</li>
                            </ol>
                        </div>
                    `;
                    break;
                    
                case 'calcular-antiguedad':
                    content = `
                        <div class="solution-box">
                            <h4>‚úÖ Soluci√≥n: Calcular Antig√ºedad de Empleados</h4>
                            <ol class="steps-list">
                                <li>Aseg√∫rese de que la columna de fecha de ingreso sea tipo Fecha</li>
                                <li>Vaya a <strong>Agregar columna ‚Üí Columna personalizada</strong></li>
                                <li>Nombre la columna "A√±os_Antig√ºedad"</li>
                                <li>Use esta f√≥rmula:<br>
                                    <code style="background: #f8f9fa; padding: 10px; display: block; margin: 10px 0; border-radius: 4px;">
                                    Duration.Days(DateTime.LocalNow() - [Fecha_Ingreso]) / 365.25
                                    </code>
                                </li>
                                <li>Para redondear a a√±os completos, modifique a:<br>
                                    <code style="background: #f8f9fa; padding: 10px; display: block; margin: 10px 0; border-radius: 4px;">
                                    Number.RoundDown(Duration.Days(DateTime.LocalNow() - [Fecha_Ingreso]) / 365.25)
                                    </code>
                                </li>
                                <li>Cambie el tipo de la columna a N√∫mero entero</li>
                                <li>Opcional: Cree categor√≠as (Nuevo: 0-2 a√±os, Experimentado: 3-5, Senior: 6+)</li>
                            </ol>
                        </div>
                    `;
                    break;
                    
                case 'resumir-ventas':
                    content = `
                        <div class="solution-box">
                            <h4>‚úÖ Soluci√≥n: Resumir Ventas por Regi√≥n</h4>
                            <ol class="steps-list">
                                <li>Seleccione <strong>Transformar ‚Üí Agrupar por</strong></li>
                                <li>En "Agrupar por", seleccione la columna "Regi√≥n"</li>
                                <li>Agregue m√∫ltiples agregaciones haciendo clic en "Agregar agregaci√≥n":</li>
                                <li>Primera agregaci√≥n: Nueva columna "Total_Ventas", Operaci√≥n "Suma", Columna "Monto_Venta"</li>
                                <li>Segunda agregaci√≥n: Nueva columna "Promedio_Venta", Operaci√≥n "Promedio", Columna "Monto_Venta"</li>
                                <li>Tercera agregaci√≥n: Nueva columna "Cantidad_Ventas", Operaci√≥n "Contar filas"</li>
                                <li>Cuarta agregaci√≥n: Nueva columna "Venta_M√°xima", Operaci√≥n "M√°x", Columna "Monto_Venta"</li>
                                <li>Haga clic en Aceptar y revise el resumen generado</li>
                                <li>Ordene por Total_Ventas descendente para ver las mejores regiones primero</li>
                            </ol>
                            <div class="tip-box" style="margin-top: 20px;">
                                <strong>üí° Tip:</strong> Puede agrupar por m√∫ltiples columnas (Regi√≥n + Vendedor) para an√°lisis m√°s detallados.
                            </div>
                        </div>
                    `;
                    break;
            }
            
            solutionDiv.innerHTML = content;
            solutionDiv.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Funciones de limpieza interactiva
        function applyClean(type) {
            const table = document.getElementById('sample-table');
            const rows = table.getElementsByTagName('tr');
            
            for (let row of rows) {
                const cells = row.getElementsByTagName('td');
                if (cells.length === 0) continue;
                
                switch(type) {
                    case 'trim':
                        cells[0].textContent = cells[0].textContent.trim();
                        break;
                        
                    case 'properCase':
                        cells[0].textContent = toProperCase(cells[0].textContent.trim());
                        break;
                        
                    case 'formatRut':
                        cells[1].textContent = formatRut(cells[1].textContent);
                        break;
                        
                    case 'cleanMoney':
                        cells[2].textContent = cleanMoney(cells[2].textContent);
                        break;
                        
                    case 'standardDate':
                        cells[3].textContent = standardizeDate(cells[3].textContent);
                        break;
                }
            }
            
            showTransformationResult(type);
        }
        
        function toProperCase(str) {
            return str.toLowerCase().replace(/\b\w/g, l => l.toUpperCase());
        }
        
        function formatRut(rut) {
            // Eliminar puntos y guiones
            let cleaned = rut.replace(/[.-]/g, '');
            // Agregar formato
            if (cleaned.length >= 2) {
                return cleaned.slice(0, -1).replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1.') + '-' + cleaned.slice(-1);
            }
            return cleaned;
        }
        
        function cleanMoney(money) {
            // Eliminar s√≠mbolos y espacios
            let cleaned = money.replace(/[$\s]/g, '').replace(/,/g, '');
            // Agregar formato decimal si no existe
            if (!cleaned.includes('.')) {
                cleaned += '.00';
            }
            return cleaned;
        }
        
        function standardizeDate(date) {
            // Convertir diferentes formatos a DD/MM/YYYY
            date = date.replace(/-/g, '/');
            const parts = date.split('/');
            if (parts.length === 3) {
                if (parts[0].length === 4) {
                    // YYYY/MM/DD
                    return `${parts[2].padStart(2, '0')}/${parts[1].padStart(2, '0')}/${parts[0]}`;
                } else if (parts[2].length === 2) {
                    // DD/MM/YY
                    return `${parts[0].padStart(2, '0')}/${parts[1].padStart(2, '0')}/20${parts[2]}`;
                }
            }
            return date;
        }
        
        function resetSampleData() {
            const table = document.getElementById('sample-table');
            table.innerHTML = `
                <tr>
                    <td style="padding: 10px;">MARIA GONZALEZ  </td>
                    <td style="padding: 10px;">12345678-9</td>
                    <td style="padding: 10px;">$1,250.00</td>
                    <td style="padding: 10px;">15/03/2024</td>
                </tr>
                <tr>
                    <td style="padding: 10px;">juan carlos silva</td>
                    <td style="padding: 10px;">98.765.432-1</td>
                    <td style="padding: 10px;">$ 850</td>
                    <td style="padding: 10px;">2024-03-16</td>
                </tr>
                <tr>
                    <td style="padding: 10px;">  Ana L√≥pez</td>
                    <td style="padding: 10px;">11222333-4</td>
                    <td style="padding: 10px;">2,100.50</td>
                    <td style="padding: 10px;">16/03/24</td>
                </tr>
            `;
            document.getElementById('transformation-result').innerHTML = '';
        }
        
        function showTransformationResult(type) {
            const resultDiv = document.getElementById('transformation-result');
            const messages = {
                'trim': '‚úÖ Se eliminaron los espacios extras al inicio y final de los nombres',
                'properCase': '‚úÖ Los nombres ahora tienen formato correcto de nombre propio',
                'formatRut': '‚úÖ Los RUT ahora tienen formato est√°ndar con puntos y gui√≥n',
                'cleanMoney': '‚úÖ Los montos ahora est√°n limpios y listos para c√°lculos',
                'standardDate': '‚úÖ Las fechas ahora tienen formato consistente DD/MM/YYYY'
            };
            
            resultDiv.innerHTML = `
                <div class="tip-box" style="margin-top: 20px;">
                    ${messages[type]}
                </div>
            `;
        }
        
        function showDiagnosticSteps() {
            const steps = `
                <div class="solution-box" style="margin-top: 30px;">
                    <h4>üìã Pasos para Corregir Problemas de Calidad de Datos</h4>
                    <ol class="steps-list">
                        <li><strong>Para espacios innecesarios:</strong><br>
                            Seleccione todas las columnas de texto ‚Üí Transformar ‚Üí Formato ‚Üí Recortar</li>
                        <li><strong>Para formatos de fecha inconsistentes:</strong><br>
                            Seleccione la columna de fecha ‚Üí Transformar ‚Üí Tipo de datos ‚Üí Usando configuraci√≥n regional</li>
                        <li><strong>Para may√∫sculas/min√∫sculas:</strong><br>
                            Seleccione columnas de nombres ‚Üí Transformar ‚Üí Formato ‚Üí Poner cada palabra en may√∫sculas</li>
                        <li><strong>Para valores monetarios:</strong><br>
                            Transformar ‚Üí Reemplazar valores ‚Üí Elimine "$" y "," ‚Üí Cambie tipo a Decimal</li>
                        <li><strong>Para detectar duplicados:</strong><br>
                            Inicio ‚Üí Agrupar por ‚Üí Agrupe por las columnas clave y cuente filas</li>
                    </ol>
                    <div class="info-box" style="margin-top: 20px;">
                        <strong>üí° Recuerde:</strong> Siempre puede ver y modificar cada paso en el panel 
                        "Pasos aplicados" del lado derecho de Power Query.
                    </div>
                </div>
            `;
            
            const diagnostic = document.querySelector('.diagnostic-tool');
            const existingSteps = diagnostic.querySelector('.solution-box');
            if (!existingSteps) {
                diagnostic.insertAdjacentHTML('beforeend', steps);
            }
        }
    </script>
</body>
</html>